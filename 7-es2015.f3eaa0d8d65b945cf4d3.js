(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{H451:function(e,t,i){"use strict";i.r(t),i.d(t,"CreateTaskModule",(function(){return T}));var r=i("tyNb"),s=i("ofXK"),a=i("Mm0v"),o=i("LPYB"),n=i("OWtv"),c=i("XNiG"),d=i("1G5W"),b=i("jfZ1"),u=i("PSD3"),l=i.n(u),m=i("fXoL"),h=i("7zfz"),p=i("JqCM"),g=i("VJ5I"),f=i("3Pt+"),D=i("zFJ7"),S=i("eO1q"),y=i("arFO");const v=["priorityForm"],P=["refCloseBtn"];function w(e,t){1&e&&(m.Pb(0,"span",29),m.Cc(1,"Task Description is required"),m.Ob())}function O(e,t){1&e&&m.Kb(0,"i",32)}function C(e,t){if(1&e){const e=m.Qb();m.Pb(0,"button",30),m.Wb("click",(function(){return m.tc(e),m.Yb().SetCrudActionName("Add")})),m.Ac(1,O,1,0,"i",31),m.Cc(2," Save "),m.Ob()}if(2&e){const e=m.Yb();m.yb(1),m.fc("ngIf",e.showLoaderIcon)}}function A(e,t){1&e&&m.Kb(0,"i",32)}function k(e,t){if(1&e){const e=m.Qb();m.Pb(0,"button",30),m.Wb("click",(function(){return m.tc(e),m.Yb().SetCrudActionName("Edit")})),m.Ac(1,A,1,0,"i",31),m.Cc(2," Update "),m.Ob()}if(2&e){const e=m.Yb();m.yb(1),m.fc("ngIf",e.showLoaderIcon)}}const L=function(){return{width:"100%"}};class M{constructor(){this.id="",this.TaskDescription="",this.DueDate=null,this.SelectedPriority={},this.SelectedAssignee={}}}const F=r.g.forChild([{path:"",component:(()=>{class e{constructor(e,t,i,r,s,a,o,n,d,b){this.commonMethodService=e,this.commonDataService=t,this.mastersService=i,this.datepipe=r,this.el=s,this.router=a,this.primeNgMessageService=o,this.notificationService=n,this.spinner=d,this.cd=b,this.onDestroy=new c.a,this.priorityList=[],this.userList=[]}ngOnInit(){this.crudData=new M,this.isAdd=!0,this.isView=!1,this.minimumDate=new Date,null==this.commonDataService.oClientConfigurationsFromJsonFile&&null!=localStorage.getItem("config")&&(this.commonDataService.oClientConfigurationsFromJsonFile=JSON.parse(localStorage.getItem("config"))),null==this.commonDataService.userList?null!=localStorage.getItem("userList")&&(this.userList=JSON.parse(localStorage.getItem("userList"))):this.userList=this.commonDataService.userList,null==this.commonDataService.priorityList?null!=localStorage.getItem("priorityList")&&(this.priorityList=JSON.parse(localStorage.getItem("priorityList"))):this.priorityList=this.commonDataService.priorityList,"update"==this.commonDataService.redirectorPage.toLowerCase()&&this.GetSetForCrud("Edit"),"reshuffle"!=this.commonDataService.redirectorPage.toLowerCase()&&"report"!=this.commonDataService.redirectorPage.toLowerCase()||this.GetSetForCrud("View")}ngAfterViewInit(){}RouteToPage(e){"back"==e&&this.router.navigate("Home"==this.commonDataService.redirectorPage?["/home"]:"Update"==this.commonDataService.redirectorPage?["/modify/update"]:"Reshuffle"==this.commonDataService.redirectorPage?["/modify/reshuffle"]:"Report"==this.commonDataService.redirectorPage?["/report"]:["/home"])}GetSetForCrud(e){if(this.crudData=new M,"Add"==e)this.isAdd=!0,this.isView=!1,this.priorityForm.resetForm();else{this.isAdd=!1,this.isView="View"==e,this.crudData.id=this.commonDataService.itemToUpdateOrView.id,this.crudData.TaskDescription=this.commonDataService.itemToUpdateOrView.message,this.crudData.DueDate=this.GetDate(this.commonDataService.itemToUpdateOrView.due_date);var t=this.priorityList.filter(e=>e.id==this.commonDataService.itemToUpdateOrView.priority);this.crudData.SelectedPriority=t[0],t=this.userList.filter(e=>e.id==this.commonDataService.itemToUpdateOrView.assigned_to),this.crudData.SelectedAssignee=t[0]}}GetDate(e){var t=e.split(" ")[0],i=Number(t.split("-")[0]),r=Number(t.split("-")[1]),s=Number(t.split("-")[2]);return new Date(i,r-1,s)}PrepCrudData(){if(this.isAdd){const e=new FormData;e.append("message",this.crudData.TaskDescription),e.append("due_date",this.datepipe.transform(this.crudData.DueDate,"yyyy-MM-dd HH:mm:ss")),e.append("priority",this.crudData.SelectedPriority.id),e.append("assigned_to",this.crudData.SelectedAssignee.id),this.Save(e,"Add")}else{const e=new FormData;e.append("taskid",this.crudData.id),e.append("message",this.crudData.TaskDescription),e.append("due_date",this.datepipe.transform(this.crudData.DueDate,"yyyy-MM-dd HH:mm:ss")),e.append("priority",this.crudData.SelectedPriority.id),e.append("assigned_to",this.crudData.SelectedAssignee.id),this.Save(e,"Edit")}}Save(e,t){let i=t;this.showLoaderIcon=!0,this.mastersService.SaveTask(e,i).pipe(Object(d.a)(this.onDestroy)).subscribe(e=>{this.showLoaderIcon=!1,"success"==e.status?(this.commonDataService.isNewTaskAdded.next(!0),this.successheader="SUCCESS",this.isAdd?(this.priorityForm.resetForm(),this.successmsg="Task has been added successfully"):this.successmsg="Task has been updated successfully",this.SweetSuccess()):"error"==e.status&&(this.errormsg=e.error,this.SweetFailure())},e=>{this.isAdd?(this.priorityForm.resetForm(),this.errormsg="Unable to add task"):this.errormsg="Unable to update task",this.SweetFailure()})}SweetSuccess(){l.a.fire(this.successheader+"!",this.successmsg,"success")}SweetFailure(){l.a.fire("Failed",this.errormsg,"error")}SetCrudActionName(e){this.crudActionName=e}ngOnDestroy(){this.onDestroy.next()}}return e.\u0275fac=function(t){return new(t||e)(m.Jb(b.b),m.Jb(b.a),m.Jb(b.c),m.Jb(s.e),m.Jb(m.l),m.Jb(r.c),m.Jb(h.g),m.Jb(b.d),m.Jb(p.b),m.Jb(m.h))},e.\u0275cmp=m.Db({type:e,selectors:[["app-crud"]],viewQuery:function(e,t){var i;1&e&&(m.Gc(v,!0),m.Gc(P,!0)),2&e&&(m.qc(i=m.Xb())&&(t.priorityForm=i.first),m.qc(i=m.Xb())&&(t.refCloseBtn=i.first))},decls:50,vars:15,consts:[[1,"wrapper"],[1,"main-panel"],[1,"content"],[1,"page-inner"],[1,"row"],[1,"col-md-1"],[1,"col-sm-12","col-md-10"],[1,"card","mb-0"],[3,"ngSubmit"],["priorityForm","ngForm"],[1,"card-header"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],["type","button",1,"btn","btn-primary","mr-1",3,"click"],[1,"card-body"],[1,"row","mt-2"],[1,"col-md-12"],[1,"col-sm-12"],[1,"pb-3"],["rows","5","cols","35","pInputTextarea","","name","TaskDescription","autoResize","autoResize","required","",3,"ngModel","ngModelChange"],["refTD","ngModel"],[1,"pt-1"],["class","text-danger",4,"ngIf"],["name","DueDate","dateFormat","dd-M-yy","appendTo","body",3,"minDate","ngModel","ngModelChange"],["name","selectedPriority","placeholder","Select priority","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],["name","SelectedAssignee","placeholder","Select assignee","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],[1,"card-footer"],[1,"d-flex","align-items-center"],["type","submit","class","btn btn-primary mr-1",3,"click",4,"ngIf"],[1,"text-danger"],["type","submit",1,"btn","btn-primary","mr-1",3,"click"],["class","fas fa-circle-notch fa-spin",4,"ngIf"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){if(1&e){const e=m.Qb();m.Pb(0,"div",0),m.Kb(1,"app-header"),m.Pb(2,"div",1),m.Pb(3,"div",2),m.Pb(4,"div",3),m.Pb(5,"div",4),m.Kb(6,"div",5),m.Pb(7,"div",6),m.Pb(8,"div",7),m.Pb(9,"form",8,9),m.Wb("ngSubmit",(function(){return m.tc(e),m.rc(10).form.valid&&t.PrepCrudData()})),m.Pb(11,"div",10),m.Pb(12,"div",11),m.Pb(13,"h4",12),m.Cc(14,"Create Task"),m.Ob(),m.Pb(15,"button",13),m.Wb("click",(function(){return t.RouteToPage("back")})),m.Cc(16,"Back"),m.Ob(),m.Ob(),m.Ob(),m.Pb(17,"div",14),m.Pb(18,"div",15),m.Pb(19,"div",16),m.Pb(20,"div",4),m.Pb(21,"div",17),m.Pb(22,"div",18),m.Pb(23,"h5"),m.Cc(24,"Task Description"),m.Ob(),m.Pb(25,"textarea",19,20),m.Wb("ngModelChange",(function(e){return t.crudData.TaskDescription=e})),m.Cc(27,"                                                        "),m.Ob(),m.Pb(28,"div",21),m.Ac(29,w,2,0,"span",22),m.Ob(),m.Ob(),m.Ob(),m.Pb(30,"div",17),m.Pb(31,"div",18),m.Pb(32,"label"),m.Cc(33,"Due Date"),m.Ob(),m.Pb(34,"p-calendar",23),m.Wb("ngModelChange",(function(e){return t.crudData.DueDate=e})),m.Ob(),m.Ob(),m.Ob(),m.Pb(35,"div",17),m.Pb(36,"div",18),m.Pb(37,"label"),m.Cc(38,"Priority"),m.Ob(),m.Pb(39,"p-dropdown",24),m.Wb("ngModelChange",(function(e){return t.crudData.SelectedPriority=e})),m.Ob(),m.Ob(),m.Ob(),m.Pb(40,"div",17),m.Pb(41,"div",18),m.Pb(42,"label"),m.Cc(43,"Assign To"),m.Ob(),m.Pb(44,"p-dropdown",25),m.Wb("ngModelChange",(function(e){return t.crudData.SelectedAssignee=e})),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Pb(45,"div",26),m.Pb(46,"div",27),m.Ac(47,C,3,1,"button",28),m.Ac(48,k,3,1,"button",28),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Kb(49,"div",5),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob()}if(2&e){const e=m.rc(10),i=m.rc(26);m.yb(25),m.yc(m.hc(14,L)),m.fc("ngModel",t.crudData.TaskDescription),m.yb(4),m.fc("ngIf",e.submitted&&(null==i.errors?null:i.errors.required)),m.yb(5),m.fc("minDate",t.minimumDate)("ngModel",t.crudData.DueDate),m.yb(5),m.fc("options",t.priorityList)("ngModel",t.crudData.SelectedPriority)("showClear",!0),m.yb(5),m.fc("options",t.userList)("ngModel",t.crudData.SelectedAssignee)("showClear",!0),m.yb(3),m.fc("ngIf",t.isAdd&&!t.isView),m.yb(1),m.fc("ngIf",!t.isAdd&&!t.isView)}},directives:[g.a,f.k,f.f,f.g,f.a,D.a,f.j,f.e,f.h,s.l,S.a,y.a],styles:[""]}),e})(),canActivate:[n.a]}]);let T=(()=>{class e{}return e.\u0275mod=m.Hb({type:e}),e.\u0275inj=m.Gb({factory:function(t){return new(t||e)},imports:[[s.c,a.a,F,o.a]]}),e})()}}]);